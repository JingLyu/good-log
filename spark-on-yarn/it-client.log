16/11/03 21:56:58 INFO SparkContext: Running Spark version 2.0.0
16/11/03 21:56:58 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
16/11/03 21:56:58 INFO SecurityManager: Changing view acls to: spiderdt
16/11/03 21:56:58 INFO SecurityManager: Changing modify acls to: spiderdt
16/11/03 21:56:58 INFO SecurityManager: Changing view acls groups to: 
16/11/03 21:56:58 INFO SecurityManager: Changing modify acls groups to: 
16/11/03 21:56:58 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(spiderdt); groups with view permissions: Set(); users  with modify permissions: Set(spiderdt); groups with modify permissions: Set()
16/11/03 21:56:59 INFO Utils: Successfully started service 'sparkDriver' on port 38274.
16/11/03 21:56:59 INFO SparkEnv: Registering MapOutputTracker
16/11/03 21:56:59 INFO SparkEnv: Registering BlockManagerMaster
16/11/03 21:56:59 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-ed3754b0-23e2-4137-97c3-53a9d0e8e746
16/11/03 21:56:59 INFO MemoryStore: MemoryStore started with capacity 1938.6 MB
16/11/03 21:56:59 INFO SparkEnv: Registering OutputCommitCoordinator
16/11/03 21:56:59 INFO log: Logging initialized @21335ms
16/11/03 21:56:59 INFO Server: jetty-9.2.z-SNAPSHOT
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@66409c1c{/jobs,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@d08b73b{/jobs/json,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@58ac4675{/jobs/job,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@4065b4ab{/jobs/job/json,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@22a760c7{/stages,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@6a5ebac7{/stages/json,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@50fbc617{/stages/stage,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@3d56e04f{/stages/stage/json,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@24ee1e7a{/stages/pool,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@3bf910a2{/stages/pool/json,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@35bcb2b4{/storage,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@3f6278d4{/storage/json,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@6b2bbc8c{/storage/rdd,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@1824dd4b{/storage/rdd/json,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@48ddf5e9{/environment,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@64d580fe{/environment/json,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@52ac8f34{/executors,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@6cdcceaf{/executors/json,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@4b091c60{/executors/threadDump,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@393b78f{/executors/threadDump/json,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@35704de6{/static,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@3fd35451{/,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@3c3aa5d7{/api,null,AVAILABLE}
16/11/03 21:56:59 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@228b4210{/stages/stage/kill,null,AVAILABLE}
16/11/03 21:56:59 INFO ServerConnector: Started ServerConnector@9c9fbf4{HTTP/1.1}{0.0.0.0:4040}
16/11/03 21:56:59 INFO Server: Started @21613ms
16/11/03 21:56:59 INFO Utils: Successfully started service 'SparkUI' on port 4040.
16/11/03 21:56:59 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://192.168.1.2:4040
16/11/03 21:56:59 INFO SparkContext: Added JAR file:/home/spiderdt/work/git/spiderdt-release/var/jar/spark_etl_expr_test.jar at spark://192.168.1.2:38274/jars/spark_etl_expr_test.jar with timestamp 1478181419783
16/11/03 21:57:00 INFO RMProxy: Connecting to ResourceManager at /192.168.1.3:8032
16/11/03 21:57:00 INFO Client: Requesting a new application from cluster with 4 NodeManagers
16/11/03 21:57:00 INFO Client: Verifying our application has not requested more than the maximum memory capability of the cluster (16384 MB per container)
16/11/03 21:57:00 INFO Client: Will allocate AM container, with 896 MB memory including 384 MB overhead
16/11/03 21:57:00 INFO Client: Setting up container launch context for our AM
16/11/03 21:57:00 INFO Client: Setting up the launch environment for our AM container
16/11/03 21:57:00 INFO Client: Preparing resources for our AM container
16/11/03 21:57:00 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
16/11/03 21:57:01 INFO Client: Uploading resource file:/tmp/spark-981f456d-add9-4476-a694-1893d0f7a4ff/__spark_libs__5519491074255958001.zip -> hdfs://192.168.1.3:9000/user/spiderdt/.sparkStaging/application_1473739536361_0530/__spark_libs__5519491074255958001.zip
16/11/03 21:57:06 INFO Client: Uploading resource file:/home/spiderdt/work/git/spiderdt-release/data-platform/target/groovy-all-2.4.7.jar -> hdfs://192.168.1.3:9000/user/spiderdt/.sparkStaging/application_1473739536361_0530/groovy-all-2.4.7.jar
16/11/03 21:57:06 INFO Client: Uploading resource file:/tmp/spark-981f456d-add9-4476-a694-1893d0f7a4ff/__spark_conf__5018800875173478997.zip -> hdfs://192.168.1.3:9000/user/spiderdt/.sparkStaging/application_1473739536361_0530/__spark_conf__.zip
16/11/03 21:57:06 INFO SecurityManager: Changing view acls to: spiderdt
16/11/03 21:57:06 INFO SecurityManager: Changing modify acls to: spiderdt
16/11/03 21:57:06 INFO SecurityManager: Changing view acls groups to: 
16/11/03 21:57:06 INFO SecurityManager: Changing modify acls groups to: 
16/11/03 21:57:06 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(spiderdt); groups with view permissions: Set(); users  with modify permissions: Set(spiderdt); groups with modify permissions: Set()
16/11/03 21:57:06 INFO Client: Submitting application application_1473739536361_0530 to ResourceManager
16/11/03 21:57:06 INFO YarnClientImpl: Submitted application application_1473739536361_0530
16/11/03 21:57:06 INFO SchedulerExtensionServices: Starting Yarn extension services with app application_1473739536361_0530 and attemptId None
16/11/03 21:57:07 INFO Client: Application report for application_1473739536361_0530 (state: ACCEPTED)
16/11/03 21:57:07 INFO Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1478181512171
	 final status: UNDEFINED
	 tracking URL: http://node3:8088/proxy/application_1473739536361_0530/
	 user: spiderdt
16/11/03 21:57:08 INFO Client: Application report for application_1473739536361_0530 (state: ACCEPTED)
16/11/03 21:57:09 INFO Client: Application report for application_1473739536361_0530 (state: ACCEPTED)
16/11/03 21:57:10 INFO YarnSchedulerBackend$YarnSchedulerEndpoint: ApplicationMaster registered as NettyRpcEndpointRef(null)
16/11/03 21:57:10 INFO YarnClientSchedulerBackend: Add WebUI Filter. org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter, Map(PROXY_HOSTS -> node3, PROXY_URI_BASES -> http://node3:8088/proxy/application_1473739536361_0530), /proxy/application_1473739536361_0530
16/11/03 21:57:10 INFO JettyUtils: Adding filter: org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter
16/11/03 21:57:10 INFO Client: Application report for application_1473739536361_0530 (state: RUNNING)
16/11/03 21:57:10 INFO Client: 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: 192.168.1.5
	 ApplicationMaster RPC port: 0
	 queue: default
	 start time: 1478181512171
	 final status: UNDEFINED
	 tracking URL: http://node3:8088/proxy/application_1473739536361_0530/
	 user: spiderdt
16/11/03 21:57:10 INFO YarnClientSchedulerBackend: Application application_1473739536361_0530 has started running.
16/11/03 21:57:10 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 35365.
16/11/03 21:57:10 INFO NettyBlockTransferService: Server created on 192.168.1.2:35365
16/11/03 21:57:10 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 192.168.1.2, 35365)
16/11/03 21:57:10 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.1.2:35365 with 1938.6 MB RAM, BlockManagerId(driver, 192.168.1.2, 35365)
16/11/03 21:57:10 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 192.168.1.2, 35365)
16/11/03 21:57:10 INFO ContextHandler: Started o.s.j.s.ServletContextHandler@7317d0ee{/metrics/json,null,AVAILABLE}
16/11/03 21:57:12 INFO YarnSchedulerBackend$YarnDriverEndpoint: Registered executor NettyRpcEndpointRef(null) (192.168.1.5:38646) with ID 1
16/11/03 21:57:12 INFO BlockManagerMasterEndpoint: Registering block manager node5:38653 with 2004.6 MB RAM, BlockManagerId(1, node5, 38653)
16/11/03 21:57:13 INFO YarnSchedulerBackend$YarnDriverEndpoint: Registered executor NettyRpcEndpointRef(null) (192.168.1.4:51924) with ID 2
16/11/03 21:57:13 INFO BlockManagerMasterEndpoint: Registering block manager node4:45528 with 2004.6 MB RAM, BlockManagerId(2, node4, 45528)
16/11/03 21:57:13 INFO YarnClientSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.8
16/11/03 21:57:13 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 218.0 KB, free 1938.4 MB)
16/11/03 21:57:13 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 20.7 KB, free 1938.4 MB)
16/11/03 21:57:13 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 192.168.1.2:35365 (size: 20.7 KB, free: 1938.6 MB)
16/11/03 21:57:14 INFO SparkContext: Created broadcast 0 from wholeTextFiles at NativeMethodAccessorImpl.java:-2
16/11/03 21:57:14 INFO FileInputFormat: Total input paths to process : 251
16/11/03 21:57:14 INFO FileInputFormat: Total input paths to process : 251
16/11/03 21:57:14 INFO CombineFileInputFormat: DEBUG: Terminated node allocation with : CompletedNodes: 4, size left: 25430
16/11/03 21:57:14 INFO SparkContext: Starting job: foreachPartition at NativeMethodAccessorImpl.java:-2
16/11/03 21:57:14 INFO DAGScheduler: Got job 0 (foreachPartition at NativeMethodAccessorImpl.java:-2) with 2 output partitions
16/11/03 21:57:14 INFO DAGScheduler: Final stage: ResultStage 0 (foreachPartition at NativeMethodAccessorImpl.java:-2)
16/11/03 21:57:14 INFO DAGScheduler: Parents of final stage: List()
16/11/03 21:57:14 INFO DAGScheduler: Missing parents: List()
16/11/03 21:57:14 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[2] at mapPartitions at NativeMethodAccessorImpl.java:-2), which has no missing parents
16/11/03 21:57:14 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 5.9 KB, free 1938.4 MB)
16/11/03 21:57:14 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 3.3 KB, free 1938.4 MB)
16/11/03 21:57:14 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 192.168.1.2:35365 (size: 3.3 KB, free: 1938.6 MB)
16/11/03 21:57:14 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1012
16/11/03 21:57:14 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 0 (MapPartitionsRDD[2] at mapPartitions at NativeMethodAccessorImpl.java:-2)
16/11/03 21:57:14 INFO YarnScheduler: Adding task set 0.0 with 2 tasks
16/11/03 21:57:14 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0, node4, partition 0, NODE_LOCAL, 22425 bytes)
16/11/03 21:57:14 INFO TaskSetManager: Starting task 1.0 in stage 0.0 (TID 1, node5, partition 1, PROCESS_LOCAL, 17270 bytes)
16/11/03 21:57:14 INFO YarnSchedulerBackend$YarnDriverEndpoint: Launching task 0 on executor id: 2 hostname: node4.
16/11/03 21:57:14 INFO YarnSchedulerBackend$YarnDriverEndpoint: Launching task 1 on executor id: 1 hostname: node5.
16/11/03 21:57:15 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on node4:45528 (size: 3.3 KB, free: 2004.6 MB)
16/11/03 21:57:15 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on node5:38653 (size: 3.3 KB, free: 2004.6 MB)
16/11/03 21:57:15 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on node4:45528 (size: 20.7 KB, free: 2004.6 MB)
16/11/03 21:57:15 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on node5:38653 (size: 20.7 KB, free: 2004.6 MB)
16/11/03 21:57:24 INFO TaskSetManager: Finished task 1.0 in stage 0.0 (TID 1) in 9411 ms on node5 (1/2)
16/11/03 21:57:25 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 10827 ms on node4 (2/2)
16/11/03 21:57:25 INFO DAGScheduler: ResultStage 0 (foreachPartition at NativeMethodAccessorImpl.java:-2) finished in 10.829 s
16/11/03 21:57:25 INFO YarnScheduler: Removed TaskSet 0.0, whose tasks have all completed, from pool 
16/11/03 21:57:25 INFO DAGScheduler: Job 0 finished: foreachPartition at NativeMethodAccessorImpl.java:-2, took 10.912739 s

16/11/03 21:57:31 INFO SparkContext: Invoking stop() from shutdown hook
16/11/03 21:57:31 INFO ServerConnector: Stopped ServerConnector@9c9fbf4{HTTP/1.1}{0.0.0.0:4040}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@228b4210{/stages/stage/kill,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@3c3aa5d7{/api,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@3fd35451{/,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@35704de6{/static,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@393b78f{/executors/threadDump/json,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@4b091c60{/executors/threadDump,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@6cdcceaf{/executors/json,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@52ac8f34{/executors,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@64d580fe{/environment/json,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@48ddf5e9{/environment,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@1824dd4b{/storage/rdd/json,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@6b2bbc8c{/storage/rdd,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@3f6278d4{/storage/json,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@35bcb2b4{/storage,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@3bf910a2{/stages/pool/json,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@24ee1e7a{/stages/pool,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@3d56e04f{/stages/stage/json,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@50fbc617{/stages/stage,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@6a5ebac7{/stages/json,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@22a760c7{/stages,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@4065b4ab{/jobs/job/json,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@58ac4675{/jobs/job,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@d08b73b{/jobs/json,null,UNAVAILABLE}
16/11/03 21:57:31 INFO ContextHandler: Stopped o.s.j.s.ServletContextHandler@66409c1c{/jobs,null,UNAVAILABLE}
16/11/03 21:57:31 INFO SparkUI: Stopped Spark web UI at http://192.168.1.2:4040
16/11/03 21:57:31 INFO YarnClientSchedulerBackend: Interrupting monitor thread
16/11/03 21:57:31 INFO YarnClientSchedulerBackend: Shutting down all executors
16/11/03 21:57:31 INFO YarnSchedulerBackend$YarnDriverEndpoint: Asking each executor to shut down
16/11/03 21:57:31 INFO SchedulerExtensionServices: Stopping SchedulerExtensionServices
(serviceOption=None,
 services=List(),
 started=false)
16/11/03 21:57:31 INFO YarnClientSchedulerBackend: Stopped
16/11/03 21:57:31 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
16/11/03 21:57:31 INFO MemoryStore: MemoryStore cleared
16/11/03 21:57:31 INFO BlockManager: BlockManager stopped
16/11/03 21:57:31 INFO BlockManagerMaster: BlockManagerMaster stopped
16/11/03 21:57:31 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
16/11/03 21:57:31 INFO SparkContext: Successfully stopped SparkContext
16/11/03 21:57:32 INFO ShutdownHookManager: Shutdown hook called
16/11/03 21:57:32 INFO ShutdownHookManager: Deleting directory /tmp/spark-981f456d-add9-4476-a694-1893d0f7a4ff
